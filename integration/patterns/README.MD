# Правила и стандарты разработки в Datareon ESB

- [Правила и стандарты разработки в Datareon ESB](#правила-и-стандарты-разработки-в-datareon-esb)
  - [Назначение документа](#назначение-документа)
  - [Регламент работы с классами информационных пакетов Datareon ESB](#регламент-работы-с-классами-информационных-пакетов-datareon-esb)
  - [Регламент работы с обработчиками 1С Datareon ESB](#регламент-работы-с-обработчиками-1с-datareon-esb)
    - [Регламент разработки обработчиков Datareon ESB](#регламент-разработки-обработчиков-datareon-esb)
    - [Правила образования наименования обработчика](#правила-образования-наименования-обработчика)
    - [Правила образования наименования класса](#правила-образования-наименования-класса)
    - [Правила комментирования](#правила-комментирования)
      - [Шаблон комментария в обработчиках](#шаблон-комментария-в-обработчиках)
    - [Общие правила комментирования](#общие-правила-комментирования)
  - [Версионирование обработчиков](#версионирование-обработчиков)

## Назначение документа

Определение внутреннего корпоративного стандарта разработки обработчиков 1С Datareon ESB в целях улучшения качества производимого программного продукта, оптимизации трудозатрат на поддержку и развитие прикладных решений.

## Регламент работы с классами информационных пакетов Datareon ESB

- Класс ИП создается с заполненной WSDL cхемой.
- Наименование класса ИП следует образовывать от терминов передаваемых данных предметной области таким образом, чтобы из имени было понятно назначение.

## Регламент работы с обработчиками 1С Datareon ESB

### Регламент разработки обработчиков Datareon ESB

- При разработке руководствоваться подходами используемые в эталонном обработчике ["Эталонный обработчик"](ЭталонныйОбработчик.bsl)
- При разработке обработчиков использовать процедуры/функции общего интеграционного модуля "грОбработкаПакетовИнтеграции"
- Инструменты для отладки обработчиков :
  - [**сшпОтладкаОбработчиков.epf**](./сшпОтладкаОбработчиков.epf) -  отладка исходящих / входящих обработчиков
  - [**сшпОтладкаОбработчиковСВходящейОчередью.epf**](./сшпОтладкаОбработчиковСВходящейОчередью.epf) отладка входящих обработчиков с возможностью получения сообщений из внутренней очереди входящих сообщений.
- Перенос изменений протестированных обработчиков разработки с префиксом "Т" в продуктивные обработчики с префиксом "П" выполняется с фиксацией версии тестового обработчика в комментарии.
Шаблон комментария - [Версия] [НаименованиеОбработчика]
Пример комментария - 5 Т_ЕРП_ЗаказПоставщику_Исходящий

### Правила образования наименования обработчика

Наименование обработчика формируется по шаблону [Актуальность]\_[КонтурРазработки]\_[СистемаОбмена]\_[НаименованиеОбработчика]\_[ТипОбработчика]  в стиле CamelCase, где

- [Актуальность] - пометка на удаление обработчика, признак не используемого, устаревшего обработчика. Принимает значение "Удалить", актуальные обработчики игнорируют данный параметр.

- [КонтурРазработки] - признак определяющий использование обработчика в интеграционном контуре, принимает следующие значения:
  - "Т" - контур разработки/тестирования.
  - "П" - контур рабочей, продуктивной среды, установка данного признака не обязательна.

- [СистемаОбмена] - наименование системы к которой подключен обработчик.
  
- [НаименованиеОбъектаСистемы] - следует образовывать от терминов объектов системы с которомы взаимодействует обработчик.

При разработке служебного исходящего обработчика, хранящего алгоритм интеграции, добавляется к [НаименованиеОбъектаСистемы] добавляется префикс "Служебный"

    Пример наименования - "Т_Ерп_СлужебныйЗаполнитьНоменклатуру_Исходящий"

    Пример вызова служебного обработчика:

    ```bsl
    
    спрДокКорРеализации.Расхождения.Очистить();
    КорРеализацияОбъект = спрДокКорРеализации;
    Выполнить(грОбработкаПакетовИнтеграции.ПолучитьТекстОбработчика("Т_Ерп_СлужебныйЗаполнитьРасхожденияКорректировкиРеализации_Исходящий", 
    Перечисления.сшпТипыИнтеграции.Исходящая));
    
    ```

- [ТипОбработчика] - признак определяющий вид обработчика может принимать значения:
  - "Исходящий"
  - "Входящий"

Примеры наименований обработчиков:

- Т_ЕРП_ЗаказПоставщику_Исходящий - обработчик тестового контура
- П_ЕРП_ЗаказПоставщику_Исходящий - обработчик продуктивного контура
- ЕРП_ЗаказПоставщику_Исходящий - обработчик продуктивного контура
- Т_ЕРП_СлужебныйСборкаДокументАктОРасхождении_Исходящий- служебный обработчик тестового контура
- Удалить_Т_ЕРП_ЗаказПоставщику_Исходящий - не используемый обработчик тестового контура

### Правила образования наименования класса

Наименование обработчика формируется по шаблону [Актуальность]\_[СистемаОбмена]\_[НаименованиеКласса]  в стиле CamelCase, где

- [Актуальность] - пометка на удаление класса, признак не используемого, устаревшего класса. Принимает значение "Удалить", актуальные обработчики игнорируют данный параметр.

- [СистемаОбмена] - наименование системы отправитель.
  
- [НаименованиеКласса] - следует образовывать от терминов прикладной логики.

### Правила комментирования

#### Шаблон комментария в обработчиках

// Градум; <ФамилияИсполнителя> (<?"", ДатаВремя, "ДФ='dd.mm.yyyy'">)); №.<НомерЗадачиЕРП> <НазваниеЗадачиЕРП> №<НомерЗадачиВнеш>

- НомерЗадачиЕРП - Номер задачи из AxelotERP.
- НазваниеЗадачиЕРП - Название задачи из AxelotERP.
- НомерЗадачиВнеш - Номер задачи из трекера заказчика. Указывается в задаче на разработку.

При изменении блоков кода необходимо указывать начало и окончание вносимых изменений. При этом, комментарий блока кода в начале должен начинаться с //+++, а комментарий в конце с //---.

__после символа "// " необходим пробел, инче автоматизированные системы проверки кода будут указывать на ошибку.__

Пример комментария:

    ```bsl

    // +++ Градум; Смирнов; 25.01.2021; №0000176234 №ITMNK-00380 
    // Измененный/Добавленный код
    // --- Градум; Смирнов; 25.01.2021; №0000176234 №ITMNK-00380 

    ```

### Общие правила комментирования

- Простой код необходимо писать и структурировать так, чтобы никаких дополнительных пояснений к нему не требовалось.
- Комментарии, которые не поясняют, а пересказывают код, недопустимы.
- Сложный код необходимо сопровождать сжатыми и четкими пояснениями.
- Длинные линейные фрагменты кода при помощи комментариев необходимо разбивать на фрагменты.
- Если код требует комментария для пояснения работы - в первую очередь необходимо рассмотреть варианты рефакторинга, чтобы код не требовал комментария.
- Длина строки комментария не должна превышать 120 символов.

## Версионирование обработчиков

Версионирование обработчиков реализовано с помощью коннектора GIT.